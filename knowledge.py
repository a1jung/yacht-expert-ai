# knowledge.py

YACHT_KNOWLEDGE_PARAS = {
    # 세일 트리밍 관련
    "세일": (
        "세일 트리밍 가이드:\n"
        "- 상단 오프닝: 바람이 강할 때 상단을 열어 압력을 줄이면 속도 안정.\n"
        "- 풀러/클로저: 풀러를 늦추면 세일 깊어짐, 당기면 평평해짐.\n"
        "- 하단: 바람이 약할 때 하단을 살짝 열어 세일 효율 극대화.\n"
        "- 트림 시 바람 방향, 배속, 코스 상황에 맞춰 미세 조절 필요."
    ),
    
    "튜닝": (
        "요트 튜닝 가이드:\n"
        "- 마스트 밴드: 팽팽하면 세일 평평, 느슨하면 세일 깊어짐.\n"
        "- 하드너(Hardner): 빗바람 시 세일 안정화.\n"
        "- 주행 조건별 튜닝: 레이스/연습/크루징마다 최적 세팅 존재.\n"
        "- 예: 레이스용 튜닝은 최대 속도, 연습용 튜닝은 안정성과 반복 훈련 위주."
    ),

    "레이스": (
        "레이스 전략:\n"
        "- 스타트 라인 근접: 포트 스타트, 스타보드 스타트 전략 다름.\n"
        "- 코스 읽기: 바람 방향, 수류, 상대 위치 분석.\n"
        "- 세일 트리밍: 풍속 변화에 따라 상단/하단/풀러 조절.\n"
        "- 턴 & 라운딩: 부표 접근시 최적 각도 계산, 전환 시 속도 유지."
    ),

    "해상훈련": (
        "해상 훈련 루틴:\n"
        "1. 트리밍/핸들링 기본 훈련\n"
        "2. 턴 및 스타보드/포트 스타트 연습\n"
        "3. 코스 시뮬레이션 레이스\n"
        "4. 긴급 상황 대응: 전복, 갑작스런 돌풍, 안전 절차 숙달"
    ),

    "육상훈련": (
        "육상 체력 훈련:\n"
        "- 코어 강화: 플랭크, 로테이션, 밸런스 운동\n"
        "- 상체/하체 근력: 스쿼트, 데드리프트, 풀업 등\n"
        "- 지구력 훈련: 조깅, 싸이클링, 로잉머신\n"
        "- 균형감각: BOSU볼, 스텝보드 활용"
    ),

    "체력루틴": (
        "주간 훈련 예시:\n"
        "- 월/수: 해상 훈련 (레이스 시뮬레이션 포함)\n"
        "- 화/목: 육상 훈련 (근력 + 코어 + 지구력)\n"
        "- 금: 시뮬레이터 훈련, 전략 회의\n"
        "- 주말: 실제 레이스, 전략 피드백"
    ),

    "안전": (
        "안전 체크리스트:\n"
        "- 구명조끼 착용 필수\n"
        "- VHF 점검, 날씨 확인\n"
        "- 구조 장비 점검 (소화기, 구명부표, 호루라기)\n"
        "- 돌풍 대비 계획 및 탈출 경로 숙지"
    ),

    # 세부 사항 추가
    "바람": (
        "바람 강도별 세일 트리밍:\n"
        "- 0~5kn: 세일 완전히 닫고 깊게, 최대 풍력 확보\n"
        "- 6~15kn: 상단 약간 열고, 평평하게 유지\n"
        "- 16~25kn: 상단 많이 열고, 세일 전체 평평하게 하여 압력 최소화\n"
        "- 26kn 이상: 긴급 세일 축소, 하강 세일 사용"
    ),

    "세일 모양": (
        "세일 포지션과 모양:\n"
        "- 상단 오픈/클로즈: 바람 강도에 따라 조절\n"
        "- 로우 포지션: 속도 극대화, 안정성 확보\n"
        "- 백스테이/하드너 활용: 세일 각도 조절과 속도 최적화"
    ),

    "레이스 종류": (
        "종목별 전략:\n"
        "- 스프린트 레이스: 스타트 중요, 즉시 최고 속도\n"
        "- 거리 레이스: 세일 균형, 지구력 중요\n"
        "- 플릿 레이스: 상대와 포지션 경쟁, 코스 읽기 중요"
    ),

    "훈련 팁": (
        "훈련 팁:\n"
        "- 해상훈련: 실제 코스에서 반복\n"
        "- 육상훈련: 코어 + 근력 + 균형 + 지구력 병행\n"
        "- 레이스 전 시뮬레이션: 바람 변화, 코스 전략 테스트"
    )
}

def free_mode_answer(user_input: str) -> str:
    """
    사용자 질문에 맞춰 무료 모드 답변 제공.
    키워드 매칭 후 전문 지식 반환.
    """
    matches = []
    for key, answer in YACHT_KNOWLEDGE_PARAS.items():
        if key in user_input:
            matches.append(answer)
    if matches:
        return "\n\n".join(matches)
    suggested = ", ".join(list(YACHT_KNOWLEDGE_PARAS.keys()))
    return f"죄송해요, 해당 질문 정보는 무료 모드에 없습니다. 대신 이런 키워드로 질문해보세요: {suggested}"
